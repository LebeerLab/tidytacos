<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Return a heatmap of prevalence of taxa in groups of samples — tacoplot_prevalences • tidytacos</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Return a heatmap of prevalence of taxa in groups of samples — tacoplot_prevalences"><meta name="description" content="Return a heatmap of all taxa above a certain threshold prevalence
per condition, clusters them and compares prevalences with a fisher_test."><meta property="og:description" content="Return a heatmap of all taxa above a certain threshold prevalence
per condition, clusters them and compares prevalences with a fisher_test."><meta property="og:image" content="https://lebeerlab.github.io/tidytacos/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidytacos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LebeerLab/tidytacos/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Return a heatmap of prevalence of taxa in groups of samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/LebeerLab/tidytacos/blob/master/R/plotters.R" class="external-link"><code>R/plotters.R</code></a></small>
      <div class="d-none name"><code>tacoplot_prevalences.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Return a heatmap of all taxa above a certain threshold prevalence
per condition, clusters them and compares prevalences with a fisher_test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tacoplot_prevalences</span><span class="op">(</span></span>
<span>  <span class="va">ta</span>,</span>
<span>  <span class="va">condition</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  fisher <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  adjp_method <span class="op">=</span> <span class="st">"fdr"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ta">ta<a class="anchor" aria-label="anchor" href="#arg-ta"></a></dt>
<dd><p>A tidytacos object.</p></dd>


<dt id="arg-condition">condition<a class="anchor" aria-label="anchor" href="#arg-condition"></a></dt>
<dd><p>The row name of the condition which rrevalences are to be compared.</p></dd>


<dt id="arg-cutoff">cutoff<a class="anchor" aria-label="anchor" href="#arg-cutoff"></a></dt>
<dd><p>The minimum prevalence of a taxon to be included in the heatmap.</p></dd>


<dt id="arg-fisher">fisher<a class="anchor" aria-label="anchor" href="#arg-fisher"></a></dt>
<dd><p>Run a fisher test on the relative prevalences in each condition
and plot the resulting adjusted p-values as *(&lt;.05), **(&lt;.01), ***(&lt;.001) or ****(&lt;.0001).</p></dd>


<dt id="arg-adjp-method">adjp_method<a class="anchor" aria-label="anchor" href="#arg-adjp-method"></a></dt>
<dd><p>The method to adjust the p-values, see <code><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html" class="external-link">rstatix::adjust_pvalue()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap</a></code></p><dl><dt><code>mat</code></dt>
<dd><p>numeric matrix of the values to be plotted.</p></dd>

    <dt><code>color</code></dt>
<dd><p>vector of colors used in heatmap.</p></dd>

    <dt><code>kmeans_k</code></dt>
<dd><p>the number of kmeans clusters to make, if we want to aggregate the
rows before drawing heatmap. If NA then the rows are not aggregated.</p></dd>

    <dt><code>breaks</code></dt>
<dd><p>a sequence of numbers that covers the range of values in mat and is one
element longer than color vector. Used for mapping values to colors. Useful, if needed
to map certain values to certain colors, to certain values. If value is NA then the
breaks are calculated automatically. When breaks do not cover the range of values,
then any value larger than <code>max(breaks)</code> will have the largest color and any value
lower than<code> min(breaks)</code> will get the lowest color.</p></dd>

    <dt><code>border_color</code></dt>
<dd><p>color of cell borders on heatmap, use NA if no border should be
drawn.</p></dd>

    <dt><code>cellwidth</code></dt>
<dd><p>individual cell width in points. If left as NA, then the values
depend on the size of plotting window.</p></dd>

    <dt><code>cellheight</code></dt>
<dd><p>individual cell height in points. If left as NA,
then the values depend on the size of plotting window.</p></dd>

    <dt><code>scale</code></dt>
<dd><p>character indicating if the values should be centered and scaled in
either the row direction or the column direction, or none. Corresponding values are
<code>"row"</code>, <code>"column"</code> and <code>"none"</code></p></dd>

    <dt><code>cluster_rows</code></dt>
<dd><p>boolean values determining if rows should be clustered or <code>hclust</code> object,</p></dd>

    <dt><code>cluster_cols</code></dt>
<dd><p>boolean values determining if columns should be clustered or <code>hclust</code> object.</p></dd>

    <dt><code>clustering_distance_rows</code></dt>
<dd><p>distance measure used in clustering rows. Possible
values are <code>"correlation"</code> for Pearson correlation and all the distances
supported by <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></code>, such as <code>"euclidean"</code>, etc. If the value is none
of the above it is assumed that a distance matrix is provided.</p></dd>

    <dt><code>clustering_distance_cols</code></dt>
<dd><p>distance measure used in clustering columns. Possible
values the same as for clustering_distance_rows.</p></dd>

    <dt><code>clustering_method</code></dt>
<dd><p>clustering method used. Accepts the same values as
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>.</p></dd>

    <dt><code>clustering_callback</code></dt>
<dd><p>callback function to modify the clustering. Is
called with two parameters: original <code>hclust</code> object and the matrix
used for clustering. Must return a <code>hclust</code> object.</p></dd>

    <dt><code>cutree_rows</code></dt>
<dd><p>number of clusters the rows are divided into, based on the
 hierarchical clustering (using cutree), if rows are not clustered, the
argument is ignored</p></dd>

    <dt><code>cutree_cols</code></dt>
<dd><p>similar to <code>cutree_rows</code>, but for columns</p></dd>

    <dt><code>treeheight_row</code></dt>
<dd><p>the height of a tree for rows, if these are clustered.
Default value 50 points.</p></dd>

    <dt><code>treeheight_col</code></dt>
<dd><p>the height of a tree for columns, if these are clustered.
Default value 50 points.</p></dd>

    <dt><code>legend</code></dt>
<dd><p>logical to determine if legend should be drawn or not.</p></dd>

    <dt><code>legend_breaks</code></dt>
<dd><p>vector of breakpoints for the legend.</p></dd>

    <dt><code>legend_labels</code></dt>
<dd><p>vector of labels for the <code>legend_breaks</code>.</p></dd>

    <dt><code>annotation_row</code></dt>
<dd><p>data frame that specifies the annotations shown on left
 side of the heatmap. Each row defines the features for a specific row. The
rows in the data and in the annotation are matched using corresponding row
 names. Note that color schemes takes into account if variable is continuous
 or discrete.</p></dd>

    <dt><code>annotation_col</code></dt>
<dd><p>similar to annotation_row, but for columns.</p></dd>

    <dt><code>annotation</code></dt>
<dd><p>deprecated parameter that currently sets the annotation_col if it is missing</p></dd>

    <dt><code>annotation_colors</code></dt>
<dd><p>list for specifying annotation_row and
annotation_col track colors manually. It is  possible to define the colors
for only some of the features. Check examples for  details.</p></dd>

    <dt><code>annotation_legend</code></dt>
<dd><p>boolean value showing if the legend for annotation
tracks should be drawn.</p></dd>

    <dt><code>annotation_names_row</code></dt>
<dd><p>boolean value showing if the names for row annotation
tracks should be drawn.</p></dd>

    <dt><code>annotation_names_col</code></dt>
<dd><p>boolean value showing if the names for column annotation
tracks should be drawn.</p></dd>

    <dt><code>drop_levels</code></dt>
<dd><p>logical to determine if unused levels are also shown in
the legend</p></dd>

    <dt><code>show_rownames</code></dt>
<dd><p>boolean specifying if column names are be shown.</p></dd>

    <dt><code>show_colnames</code></dt>
<dd><p>boolean specifying if column names are be shown.</p></dd>

    <dt><code>main</code></dt>
<dd><p>the title of the plot</p></dd>

    <dt><code>fontsize</code></dt>
<dd><p>base fontsize for the plot</p></dd>

    <dt><code>fontsize_row</code></dt>
<dd><p>fontsize for rownames (Default: fontsize)</p></dd>

    <dt><code>fontsize_col</code></dt>
<dd><p>fontsize for colnames (Default: fontsize)</p></dd>

    <dt><code>angle_col</code></dt>
<dd><p>angle of the column labels, right now one can choose only from few
predefined options (0, 45, 90, 270 and 315)</p></dd>

    <dt><code>display_numbers</code></dt>
<dd><p>logical determining if the numeric values are also printed to
the cells. If this is a matrix (with same dimensions as original matrix), the contents
of the matrix are shown instead of original values.</p></dd>

    <dt><code>number_format</code></dt>
<dd><p>format strings (C printf style) of the numbers shown in cells.
For example "<code>%.2f</code>" shows 2 decimal places and "<code>%.1e</code>" shows exponential
notation (see more in <code><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></code>).</p></dd>

    <dt><code>number_color</code></dt>
<dd><p>color of the text</p></dd>

    <dt><code>fontsize_number</code></dt>
<dd><p>fontsize of the numbers displayed in cells</p></dd>

    <dt><code>gaps_row</code></dt>
<dd><p>vector of row indices that show where to put gaps into
heatmap. Used only if the rows are not clustered. See <code>cutree_row</code>
to see how to introduce gaps to clustered rows.</p></dd>

    <dt><code>gaps_col</code></dt>
<dd><p>similar to gaps_row, but for columns.</p></dd>

    <dt><code>labels_row</code></dt>
<dd><p>custom labels for rows that are used instead of rownames.</p></dd>

    <dt><code>labels_col</code></dt>
<dd><p>similar to labels_row, but for columns.</p></dd>

    <dt><code>filename</code></dt>
<dd><p>file path where to save the picture. Filetype is decided by
the extension in the path. Currently following formats are supported: png, pdf, tiff,
 bmp, jpeg. Even if the plot does not fit into the plotting window, the file size is
calculated so that the plot would fit there, unless specified otherwise.</p></dd>

    <dt><code>width</code></dt>
<dd><p>manual option for determining the output file width in inches.</p></dd>

    <dt><code>height</code></dt>
<dd><p>manual option for determining the output file height in inches.</p></dd>

    <dt><code>silent</code></dt>
<dd><p>do not draw the plot (useful when using the gtable output)</p></dd>

    <dt><code>na_col</code></dt>
<dd><p>specify the color of the NA cell in the matrix.</p></dd>


</dl></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">urt</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="aggregate_taxa.html">aggregate_taxa</a></span><span class="op">(</span>rank <span class="op">=</span> <span class="st">"order"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tacoplot_prevalences</span><span class="op">(</span><span class="va">location</span>, cutoff <span class="op">=</span> <span class="fl">.1</span>,</span></span>
<span class="r-in"><span>  treeheight_row <span class="op">=</span> <span class="fl">0</span>, cutree_rows <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  fontsize <span class="op">=</span> <span class="fl">6</span>, cellwidth <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tacoplot_prevalences-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Wittouck, Tim Van Rillaer, Wenke Smets, Sarah Lebeer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

