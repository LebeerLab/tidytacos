<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>(Re)classify amplicon sequences — classify_taxa • tidytacos</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(Re)classify amplicon sequences — classify_taxa"><meta name="description" content="This function requires the DADA2 package to be installed."><meta property="og:description" content="This function requires the DADA2 package to be installed."><meta property="og:image" content="https://lebeerlab.github.io/tidytacos/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidytacos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LebeerLab/tidytacos/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>(Re)classify amplicon sequences</h1>
      <small class="dont-index">Source: <a href="https://github.com/LebeerLab/tidytacos/blob/v1.0.3/R/adders_taxa.R" class="external-link"><code>R/adders_taxa.R</code></a></small>
      <div class="d-none name"><code>classify_taxa.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function requires the DADA2 package to be installed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">classify_taxa</span><span class="op">(</span></span>
<span>  <span class="va">ta</span>,</span>
<span>  <span class="va">refdb</span>,</span>
<span>  taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">T</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">taxon_id</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ranks <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  sequence_var <span class="op">=</span> <span class="st">"sequence"</span>,</span>
<span>  multithread <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  min_boot <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_ranks <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ta">ta<a class="anchor" aria-label="anchor" href="#arg-ta"></a></dt>
<dd><p>A tidytacos object.</p></dd>


<dt id="arg-refdb">refdb<a class="anchor" aria-label="anchor" href="#arg-refdb"></a></dt>
<dd><p>The path to a DADA2-compatible reference database.</p></dd>


<dt id="arg-taxa">taxa<a class="anchor" aria-label="anchor" href="#arg-taxa"></a></dt>
<dd><p>An expression that specifies which taxa to (re)classify.</p></dd>


<dt id="arg-ranks">ranks<a class="anchor" aria-label="anchor" href="#arg-ranks"></a></dt>
<dd><p>A vector that specifies which ranks to (re)classify.</p></dd>


<dt id="arg-sequence-var">sequence_var<a class="anchor" aria-label="anchor" href="#arg-sequence-var"></a></dt>
<dd><p>The (quoted) name of a variable within the taxa table
that contains (representative) sequences of the taxa.</p></dd>


<dt id="arg-multithread">multithread<a class="anchor" aria-label="anchor" href="#arg-multithread"></a></dt>
<dd><p>A boolean indicating whether to use multiple threads.</p></dd>


<dt id="arg-min-boot">min_boot<a class="anchor" aria-label="anchor" href="#arg-min-boot"></a></dt>
<dd><p>The minimum bootstrap value for taxonomy assignment.</p></dd>


<dt id="arg-n-ranks">n_ranks<a class="anchor" aria-label="anchor" href="#arg-n-ranks"></a></dt>
<dd><p>The number of ranks present in the reference database.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated tidytacos object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>classify_taxa()</code> will (re)classify either all or a subset of the taxa, given
that a variable is present in the taxon table that contains (representative)
sequences of the taxa.</p>
<p>Ranks can be supplied as a named integer vector, where the names represent
taxonomic ranks and the integers represent positions of these ranks in the
taxonomy strings present in the reference database. Ranks can also be
supplied as just a character vector with the rank names; in that case, it is
assumed that the database taxonomy string follows the default order
(domain, phylum, class, order, family, genus, species).
If no ranks are supplied, taxa will be (re)classified at all default ranks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we create a mock database</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span><span class="st">"&gt;Level1;Level2;Level3;Level4;Level5;Level6;"</span>,</span></span>
<span class="r-in"><span><span class="st">"ACCTAGAAAGTCGTAGATCGAAGTTGAAGCATCGCCCGATGATCGTCTGAAGCTGTAGCATGAGTCGATTTTCACATTCAGGGATACCATAGGATAC"</span>, </span></span>
<span class="r-in"><span><span class="st">"&gt;Level1;Level2;Level3;Level4;Level5;"</span>,</span></span>
<span class="r-in"><span><span class="st">"CGCTAGAAAGTCGTAGAAGGCTCGGAGGTTTGAAGCATCGCCCGATGGGATCTCGTTGCTGTAGCATGAGTACGGACATTCAGGGATCATAGGATAC"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># and write it to a file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/write.html" class="external-link">write</a></span><span class="op">(</span><span class="va">x</span>, file<span class="op">=</span><span class="st">"tmp-db.fna"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">urt_reclass</span> <span class="op">&lt;-</span> <span class="va">urt</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="co"># filter out samples to save time</span></span></span>
<span class="r-in"><span><span class="fu"><a href="filter_samples.html">filter_samples</a></span><span class="op">(</span><span class="va">sample_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>,<span class="st">"s2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu">classify_taxa</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"tmp-db.fna"</span>, n_ranks <span class="op">=</span> <span class="fl">6</span>, <span class="co"># the mock database is used here</span></span></span>
<span class="r-in"><span>  ranks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"kingdom"</span>,<span class="st">"phylum"</span>, <span class="st">"class"</span>, <span class="st">"order"</span>, <span class="st">"family"</span>, <span class="st">"genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># remove the temp file</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"tmp-db.fna"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Wittouck, Tim Van Rillaer, Wenke Smets, Sarah Lebeer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

