<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidytacos quick start guide • tidytacos</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidytacos quick start guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidytacos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/LebeerLab/tidytacos/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="getting-started_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="getting-started_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="getting-started_files/plotly-binding-4.11.0/plotly.js"></script><script src="getting-started_files/typedarray-0.1/typedarray.min.js"></script><link href="getting-started_files/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="getting-started_files/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="getting-started_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="getting-started_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidytacos quick start guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LebeerLab/tidytacos/blob/v1.0.8/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<p>This guide explains how to perform some common microbial sequencing
count data analysis tasks using tidytacos. We will illustrate those
using a dataset with human microbiome samples from the upper respiratory
tract (URT), taken from <a href="https://www.frontiersin.org/articles/10.3389/fmicb.2017.02372/full" class="external-link">this
paper</a> by De Boeck et al. It contains nose as well as nasopharynx
samples. Most samples were taken using a swab method, but a minority was
taking with the aspirate method.</p>
<div class="section level2">
<h2 id="philosophy-of-the-package">Philosophy of the package<a class="anchor" aria-label="anchor" href="#philosophy-of-the-package"></a>
</h2>
<p>A tidytacos object is simply a list of three tables:</p>
<ul>
<li>
<strong>counts</strong>: These are the counts of reads for each
taxon (OTU/ASV/phylotype) in each sample. Each row represents such a
read count.</li>
<li>
<strong>samples</strong>: This table contains the sample metadata.
Each row represents a sample.</li>
<li>
<strong>taxa</strong>: This table contains the taxonomy and other
metadata for the taxa. Each row represents a taxon.</li>
</ul>
<p>The package is called tidytacos because each of the tables is tidy:
every row represents an observation and every column a variable (more on
data tidying can be found at <a href="https://r4ds.hadley.nz/data-tidy.html#sec-tidy-data" class="external-link uri">https://r4ds.hadley.nz/data-tidy.html#sec-tidy-data</a>).
For this quick start guide, we assume you are familiar with the
tidyverse (especially dplyr and ggplot).</p>
<p>The main differences with the popular phyloseq package are:</p>
<ul>
<li>The abundance table of tidytacos is in long format, while the
otu_table object of phyloseq is in wide (matrix) format. A tidy read
count table is more compact for very sparse data (such as microbiome
data), and also easier to handle and visualize within the tidyverse
framework.</li>
<li>All tables in tidytacos are data frames (technically tibbles). In
phyloseq, each table has its own special data type (i.e. the classes
“otu_table”, “tax_table” and “sample_data”). This makes it sometimes
difficult to access the data directly and do simple stuff with it. Also,
the otu_table and tax_table classes are based on the matrix type, while
the sample_data class is based on the dataframe type. This also makes
data manipulation sometimes unstraightforward.</li>
<li>In a phyloseq otu table, sometimes the rows are the taxa and
sometimes the columns. This can easily lead to errors.</li>
</ul>
</div>
<div class="section level2">
<h2 id="setting-up">Setting up<a class="anchor" aria-label="anchor" href="#setting-up"></a>
</h2>
<p>In case you haven’t installed tidytacos yet, it can be installed
using devtools:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"LebeerLab/tidytacos"</span><span class="op">)</span></span></code></pre></div>
<p>For this guide, we only need to load two packages: tidytacos (of
course) and the tidyverse set of packages.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.6</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.6.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 4.0.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.2</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.2.1     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lebeerlab.github.io/tidytacos/">tidytacos</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidytacos'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     everything</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:tidyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     everything</span></span></code></pre></div>
<p>The first step will usually be the conversion our data into a usable
tidytacos format. If, for example, you used DADA2 as explained <a href="http://rstudio-pubs-static.s3.amazonaws.com/273862_8258982fdfac49a8ba9d6ed651b9b539.html" class="external-link">here</a>,
you can hand off the data to tidytacos using <code><a href="../reference/from_dada.html">from_dada()</a></code>.
You can also convert a phyloseq object to a tidytacos object using the
<code><a href="../reference/from_phyloseq.html">from_phyloseq()</a></code></p>
<p>function. More options to import and convert your data can be found
<a href="https://lebeerlab.github.io/tidytacos/reference/index.html#file-handling">here</a>.</p>
<p>A tidytacos object is read and stored as three sparse tables
(counts-, taxa- and samples.csv). The sample table needs atleast a
<code>sample_id</code> column, the taxa table needs a
<code>taxon_id</code> column with atleast one other rank name column and
the counts table needs a <code>sample_id</code>, <code>taxon_id</code>
and <code>counts</code> column. The taxa table of a default tidytacos
object has the domain, phylum, class, order, family, genus and species
columns. Species here has a special place as it is often ignored by some
functions unless specified, due to the low resolution of short read 16S
rRNA gene sequencing data.</p>
<p>To read in existing data from a folder called ‘my_data’ you would
run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tidytacos"</span>, <span class="st">"leaf"</span>, package <span class="op">=</span> <span class="st">"tidytacos"</span><span class="op">)</span></span>
<span><span class="co"># my_path &lt;- "local/path/my_data"</span></span>
<span><span class="va">taco</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tidytacos.html">read_tidytacos</a></span><span class="op">(</span><span class="va">my_path</span><span class="op">)</span></span></code></pre></div>
<p>Where you replace my_path with an actual path to your data. The path
used here uses data in our package.</p>
<p>To write your data to a folder called “my_data_filtered” you can
run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taco</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/write_tidytacos.html">write_tidytacos</a></span><span class="op">(</span><span class="st">"my_data_filtered"</span><span class="op">)</span></span></code></pre></div>
<p>However, our example dataset is available in the tidytacos package
and doesn’t need to be imported or converted. It is called “urt” and we
start by inspecting the samples table:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">urt</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 217</span></span>
<span><span class="co">#&gt; Columns: 9</span></span>
<span><span class="co">#&gt; $ run         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "20161207_ilke_urt100"<span style="color: #949494;">, </span>"20161207_ilke_urt100"<span style="color: #949494;">, </span>"20161207_…</span></span>
<span><span class="co">#&gt; $ condition   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"CON"<span style="color: #949494;">, </span>"C…</span></span>
<span><span class="co">#&gt; $ participant <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CON100"<span style="color: #949494;">, </span>"CON100"<span style="color: #949494;">, </span>"CON10"<span style="color: #949494;">, </span>"CON10"<span style="color: #949494;">, </span>"CON11"<span style="color: #949494;">, </span>"CON11"<span style="color: #949494;">, </span>"C…</span></span>
<span><span class="co">#&gt; $ location    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "NF"<span style="color: #949494;">, </span>"N"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"N"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"N"<span style="color: #949494;">, </span>"NF"<span style="color: #949494;">, </span>"…</span></span>
<span><span class="co">#&gt; $ method      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"A"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"<span style="color: #949494;">, </span>"S"…</span></span>
<span><span class="co">#&gt; $ plate       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ passes_qc   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE<span style="color: #949494;">, </span>TRUE…</span></span>
<span><span class="co">#&gt; $ sample      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "CON100-NF-S"<span style="color: #949494;">, </span>"CON100-N-S"<span style="color: #949494;">, </span>"CON10-NF-A"<span style="color: #949494;">, </span>"CON10-NF-S"<span style="color: #949494;">, </span>"…</span></span>
<span><span class="co">#&gt; $ sample_id   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "s1"<span style="color: #949494;">, </span>"s2"<span style="color: #949494;">, </span>"s3"<span style="color: #949494;">, </span>"s4"<span style="color: #949494;">, </span>"s5"<span style="color: #949494;">, </span>"s6"<span style="color: #949494;">, </span>"s7"<span style="color: #949494;">, </span>"s8"<span style="color: #949494;">, </span>"s9"<span style="color: #949494;">, </span>"s10…</span></span></code></pre></div>
<p>We then have a quick look at the total number of samples, ASVs, and
reads in the tidytacos object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tacosum.html">tacosum</a></span><span class="op">(</span><span class="va">urt</span><span class="op">)</span></span>
<span><span class="co">#&gt; n_samples    n_taxa   n_reads </span></span>
<span><span class="co">#&gt;       217      1957   3873478</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="making-a-stacked-barplot-of-a-subset-of-samples">Making a stacked barplot of a subset of samples<a class="anchor" aria-label="anchor" href="#making-a-stacked-barplot-of-a-subset-of-samples"></a>
</h2>
<p>We can very easily create a plot to explore a subset of our samples
(e.g., only nose samples taken with the swab method) in the following
way:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/filter_samples.html">filter_samples</a></span><span class="op">(</span><span class="va">location</span> <span class="op">==</span> <span class="st">"N"</span>, <span class="va">method</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/tacoplot_stack.html">tacoplot_stack</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/stack-plot-1.png" class="r-plt" alt="" width="768"></p>
<p>The <code>filter_samples</code> function does what it says: filtering
samples. It will also delete taxa from the taxa table that have zero
total reads in the remaining samples. The <code>tacoplot_stack</code>
function returns a nice stacked bar plot visualization of the most
abundant taxa in our samples.</p>
</div>
<div class="section level2">
<h2 id="subsetting-dataset">Subsetting dataset<a class="anchor" aria-label="anchor" href="#subsetting-dataset"></a>
</h2>
<p>Our next question for this dataset is to what extent nose and
nasopharynx are linked from a microbiological point of view. To get an
idea we can first visualize this:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt_s</span> <span class="op">&lt;-</span> <span class="va">urt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/filter_samples.html">filter_samples</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tacoplot_stack.html">tacoplot_stack</a></span><span class="op">(</span><span class="va">urt_s</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="op">-</span><span class="fl">0.02</span>,color<span class="op">=</span><span class="va">location</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/subset-plot-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tacoplot_stack.html">tacoplot_stack</a></span><span class="op">(</span><span class="va">urt_s</span>, x <span class="op">=</span> <span class="va">location</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">participant</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in tacoplot_stack(urt_s, x = location): Sample labels not unique,</span></span>
<span><span class="co">#&gt; samples are aggregated.</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/facet-plot-1.png" class="r-plt" alt="" width="768"></p>
<p>First, we make sure to include only swab samples. We can then
visualize the data in stacked bar plots. The tacoplot functions consist
of ggplot function calls and therefore geoms and other ggplot features
can be added.</p>
</div>
<div class="section level2">
<h2 id="alpha-diversity">Alpha diversity<a class="anchor" aria-label="anchor" href="#alpha-diversity"></a>
</h2>
<p>To explore alpha diversity, let’s create a rarefied version of the
dataset:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt_rar</span> <span class="op">&lt;-</span> <span class="va">urt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_total_count.html">add_total_count</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/filter_samples.html">filter_samples</a></span><span class="op">(</span><span class="va">total_count</span> <span class="op">&gt;=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rarefy.html">rarefy</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_alphas.html">add_alphas</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize alpha diversities of nose versus the
nasopharynx:</p>
<p>The <code>add_total_count</code> function will add total sample read
numbers to the sample table.</p>
<p>The <code>rarefy</code> function will randomly subsample all samples
n times. It only works if the read count of each sample equals or
exceeds n. For determining ASV richness, we chose to rarefy first, but
this may depend on your data.</p>
<p>The <code>add_alpha</code> function can be used to add several
metrics of alpha diversity to the sample table or in this cas we use the
add_alphas to add all the currently supported metrics.</p>
<p>Next we will plot the resulting alpha diversities and group per
location of sampling:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt_rar</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/tacoplot_alphas.html">tacoplot_alphas</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_ydensity()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-alpha-1.png" class="r-plt" alt="" width="672"></p>
<p>The tacoplot_alphas function will use any alpha metric that has been
added by add_alpha(s) which it can find in the sample table.</p>
</div>
<div class="section level2">
<h2 id="principal-coordinates-analysis">Principal coordinates analysis<a class="anchor" aria-label="anchor" href="#principal-coordinates-analysis"></a>
</h2>
<p>We would like to address the differences between nose and
nasopharynx. We’re also more interested in genera than ASVs. A PCA might
offer insight:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt_genus</span> <span class="op">&lt;-</span> <span class="va">urt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/filter_samples.html">filter_samples</a></span><span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"S"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/aggregate_taxa.html">aggregate_taxa</a></span><span class="op">(</span>rank <span class="op">=</span> <span class="st">"genus"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tacoplot_ord_ly.html">tacoplot_ord_ly</a></span><span class="op">(</span><span class="va">urt_genus</span>,<span class="va">location</span>, samplenames <span class="op">=</span> <span class="va">sample</span>, dim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in remove_empty_samples(.): Removed 2 empty samples.</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"visdat":{"283928cb3f34":["function () ","plotlyVisDat"]},"cur_data":"283928cb3f34","attrs":{"283928cb3f34":{"x":{},"y":{},"z":{},"text":{},"hovertemplate":"<i>%{text}<\/i>","color":{},"colors":["#e8e8e8","#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"PCOA plot","yaxis":{"zeroline":false},"xaxis":{"zeroline":false},"scene":{"xaxis":{"title":"ord1"},"yaxis":{"title":"ord2"},"zaxis":{"title":"ord3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0.30341154338864801,0.30871026021531661,0.32888540179799824,0.26931240929981959,0.14516623447026897,0.27269486187706843,0.28549254460240464,0.15461057120456059,0.28211922635021719,0.20968184473820317,0.26693667586661085,0.18109671348650111,0.13050541590559392,-0.28064991271259504,0.30987774562552806,0.23849876410573281,0.0050494262673652941,0.1098332907689759,-0.12362105236862563,0.30518938596841855,0.26190273632212996,-0.19975454986383143,0.33157878179664513,0.30558481470630311,0.24607066451278614,0.31098700124221246,0.28431025005408961,0.22398108608292938,0.16730570305647929,-0.55444308500984008,-0.44161029645235683,0.19904687305731,0.085473720608332457,-0.076035038217665371,0.29012903366366372,-0.10352133214130509,0.23233625155367976,0.23796726059789031,0.32187177542591672,0.31843188461941274,0.26786528050156627,-0.13846711064572251,0.22661371916470763,0.23248686140693456,-0.24679001830455546,-0.04230851921387626,0.26155235621277251,0.32253061616677181,0.21744769925393323,0.2831546337644063,-0.011896882740013926,-0.0071816381812000885,0.21067865783599257,0.053452923059338457,0.1174909286893447,0.12329283411672839,-0.13073182856582186,0.2375181433337194,0.089388800226861506,0.26197249415934121,0.27540850142449785,0.29721754417328961,0.10165493982617899,0.012390993566249847,-0.46475886465767541,-0.090860238783206093,0.1248206225639404,0.33021240536202873,0.31156768708897126,0.27213975151762049,0.19986654883420293,0.18024312220303798,0.24119180979966698,0.29921308534206886,-0.09960932463842205,0.30232213779728628,0.17968948306642482,0.28947641423461778,-0.43186034851029231,0.25606541325743915,0.083656336613379512,0.3185065212890224,0.34466523511156338,0.30058486687416436,0.062306016425882862],"y":[0.015994020150006505,-0.12770130536009902,-0.13362202366167858,-0.12341325713736925,0.16245853450151196,0.032265682431698278,0.048511327972572779,0.12871990143147941,0.077547923427293414,0.10025247001949399,0.016656416346642593,0.1120049739785437,0.18719558192853611,-0.41946544596181751,-0.014617207781622557,-0.19616560971476113,0.21638399518818238,-0.066322513493350707,0.11655413518232197,-0.23042959200435262,-0.1036277131516667,-0.426227914207297,-0.23769185283721364,0.021912431828529567,-0.066085715201869635,-0.068958931982750729,-0.072369025820406607,0.061554077739393157,0.089821637187298853,-0.23991951776241571,-0.30469180932307122,0.074648500035206206,0.090039115389927635,0.047472620588891484,-0.24818077677309675,0.20111571179645008,-0.16637305011165227,-0.062843911484856907,-0.22019856887652259,-0.19571945991289474,-0.098861170159512471,0.36105290102898824,0.0040308844102098316,-0.24696630297662722,-0.41172851279455525,0.066602642972063433,-0.11101098735471043,-0.13232419146708174,-0.083217157118953972,-0.25366353950476578,0.30587197727188647,-0.33979582735591302,0.01466639031494296,0.22749928529005722,0.14783443817600952,-0.077250035040929338,0.34493904382139828,-0.19865000244474015,0.10964318579232991,-0.092785694463812143,-0.085880918791293864,-0.20039697646067733,0.24489343398054492,0.30934024610530297,-0.44763962524042095,0.11855419229528244,0.016936854355476951,-0.14225445176050552,-0.1336141678496871,0.032194133798339013,0.10976890558044052,0.15514271872143517,0.042666534851719354,-0.2671287913733898,0.3079218138120004,0.0052628461784477755,0.16643651412778301,0.036196389631989789,-0.39253658728031354,-0.09271932672486044,0.19938493865069454,-0.060429677929527109,-0.066703892006250182,-0.15811707267821526,0.25253982893322313],"z":[0.030657219546176492,-0.12154304925168856,-0.11723240494871996,-0.093077783727803773,0.23497958695891349,0.09784849609215622,0.076270079597061446,0.092330152370852847,0.1325071482480667,0.14538325671324961,0.070871067649394187,0.098839595091712681,0.13055500412522136,0.1558323770320216,0.055184588326401607,-0.19375630435547109,-0.013595422385894524,0.055895977261742086,0.054626496778293038,-0.22136453309522289,-0.060595101337741583,0.12551542550145289,-0.23529376768232324,0.064521427589244382,-0.14540945143103837,-0.074016662278670514,-0.018535945623379603,0.1012846965564974,0.14748013692976736,0.10995722319303046,0.23125766917613663,0.082787825331858411,0.16796992303082234,0.052423183766951459,-0.25049688149355132,-0.051563002129028097,-0.21048970743367865,-0.027504255366471862,-0.20532340638255045,-0.16208363801564454,-0.016960445859432956,0.232874124453092,0.033247470762286194,-0.11540972416507947,0.1865370965738016,0.17761238257858461,-0.1441954878839305,-0.10702688365713925,-0.063681701642644611,-0.23953052345015302,0.23914153657597365,-0.024084497947246451,0.042920118363055523,0.22134628814631291,0.083535189359979278,-0.10313144336370103,-0.030683898588674714,-0.11536255624227505,0.19900562116563933,-0.060964954617444382,-0.049043942151082348,-0.20711960657466252,0.21605687338252538,0.27965953615343447,0.17068324533987608,-0.18484085329845673,-0.099255069208518537,-0.10313337191596232,-0.069258824503058078,0.07629160731005713,0.08976845903442264,0.2148206808296298,0.11337512228417138,-0.23261824637494821,0.18283471407952911,0.078359788003014505,0.20039554334085002,0.089975357105574874,0.21783566372162022,-0.13291688511399211,0.070425135593728538,-0.034736670343981667,-0.008421184143274793,-0.13111533234526365,0.28606161968698618],"text":["CON100-N-S","CON11-N-S","CON13-N-S","CON14-N-S","CON15-N-S","CON16-N-S","CON17-N-S","CON18-N-S","CON19-N-S","CON20-N-S","CON21-N-S","CON22-N-S","CON23-N-S","CON24-N-S","CON25-N-S","CON26-N-S","CON27-N-S","CON28-N-S","CON29-N-S","CON30-N-S","CON31-N-S","CON33-N-S","CON35-N-S","CON36-N-S","CON37-N-S","CON38-N-S","CON39-N-S","CON40-N-S","CON41-N-S","CON42-N-S","CON43-N-S","CON44-N-S","CON45-N-S","CON46-N-S","CON47-N-S","CON48-N-S","CON49-N-S","CON50-N-S","CON51-N-S","CON52-N-S","CON53-N-S","CON54-N-S","CON55-N-S","CON56-N-S","CON57-N-S","CON59-N-S","CON60-N-S","CON61-N-S","CON62-N-S","CON63-N-S","CON64-N-S","CON65-N-S","CON66-N-S","CON67-N-S","CON68-N-S","CON69-N-S","CON70-N-S","CON71-N-S","CON72-N-S","CON74-N-S","CON75-N-S","CON76-N-S","CON77-N-S","CON78-N-S","CON79-N-S","CON80-N-S","CON81-N-S","CON82-N-S","CON83-N-S","CON84-N-S","CON85-N-S","CON86-N-S","CON87-N-S","CON88-N-S","CON89-N-S","CON90-N-S","CON91-N-S","CON92-N-S","CON93-N-S","CON94-N-S","CON95-N-S","CON96-N-S","CON97-N-S","CON98-N-S","CON99-N-S"],"hovertemplate":["<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>"],"type":"scatter3d","mode":"markers","name":"N","marker":{"color":"rgba(232,232,232,1)","line":{"color":"rgba(232,232,232,1)"}},"textfont":{"color":"rgba(232,232,232,1)"},"error_y":{"color":"rgba(232,232,232,1)"},"error_x":{"color":"rgba(232,232,232,1)"},"line":{"color":"rgba(232,232,232,1)"},"frame":null},{"x":[0.34336977636054317,-0.5614111780114337,0.30469423217741215,0.042284768458898531,0.038723197540078184,-0.43510119561738453,0.0051701009847971479,-0.043124448478850504,-0.00035223624235014881,-0.16354569153146248,0.014688865115492982,-0.1848211366424049,-0.25397832309544527,-0.15576961433030961,-0.039879005815872372,-0.23923320455905203,-0.11350835752905908,0.19163669266785008,-0.3570870117713818,-0.15159401181936824,-0.58339267518219229,0.13811937957143952,-0.1435500764067511,-0.38300736574964356,-0.2756326485246019,-0.15552669438780523,-0.31593801202418464,-0.40545255065096342,-0.38842205027485749,-0.52197121135183266,-0.40399213435144576,-0.20798284442660628,-0.54249524705864571,-0.0066141373023957967,-0.43716111053376899,-0.44014447481693414,0.058792247360318843,0.075795207103125886,-0.13873506237743316,0.27770520586244818,-0.083045559717719125,-0.10753169684632576,-0.4017693031149972,-0.077655368112604706,0.14658019059705166,-0.39163572156130805,0.026825939585201571,-0.24953724472262628,-0.31333235695737793,-0.11326096127708592,0.19989127675581514,-0.36494679252345719,-0.30805678826368399,-0.20138587576258321,-0.14579247983571142,0.01896830424931447,0.27953579521416355,-0.16942913436700985,-0.39556290480178069,0.028320147649040003,-0.48926637297272069,0.29879058325589031,0.32613039115143261,-0.39818201768277101,0.29539335685719653,0.053087877182980935,-0.44110319529738506,-0.40454260740342413,-0.44562944110628289,0.29809170367739507,-0.17534132782835904,-0.41432734658323672,-0.53739973499792748,-0.13164653836491219,-0.050561023727157532,-0.22910159632742341,0.27751090616671609,0.25984096117431998,-0.35463929579294157,-0.028223075423419869,0.09063565300423175,-0.53915245873844031,-0.15486009725039451,0.2326634026154249,-0.1531295231194692,0.093666398902270451,0.057792695461879345,-0.12476140785261629,-0.0502119134250118,0.093931671027778357,0.19227746359449099,0.33964733742414971,-0.13860757617365668,-0.093546963357922966,-0.54255781309092499],"y":[-0.11245133477288653,-0.19418162272987816,-0.086736389104480005,0.20396308235226032,-0.4096755216608835,-0.24252382778435971,0.2482050947961956,0.24016351120566093,0.34528649156763563,-0.02400902024743921,0.29360791787157503,0.059840191796498493,0.021228294806240704,0.23093433647071027,0.28665554498904511,0.20904630390572279,-0.4133059666097636,0.10908337092985784,0.2273013390544581,0.2355935763923668,-0.18172319067943554,0.21391307751300553,0.39920827344262977,0.27405101279597216,0.036549526536972306,-0.33517697957336995,0.12032375072790991,0.3128280530187359,0.26053794636507105,-0.42736484096557731,0.25766297703529401,0.22670857302485412,-0.46744141947496626,0.1737284043074194,-0.0016206855370019147,-0.22468187778554549,0.11748642689613766,0.12596575131138632,-0.0072404075560753281,-0.2475006466756498,0.31114523102184127,0.018928470017739632,-0.12525285321209609,0.15593177291997706,-0.00059195868607349583,0.079096311778401637,0.13389398114160064,0.017315759749493165,0.036677415126707164,-0.41814053498846876,-0.11418204975055884,-0.08937455823192135,0.25584418607142562,0.032376424987018405,0.17619635360249411,0.064847846614432825,-0.24985100512508535,0.29063938569073028,0.24097060022475644,-0.0045132502142588024,-0.42497529078294122,-0.18376698302102523,-0.29297727298432819,0.27036568532824473,-0.1796393494036978,0.15976866275443499,-0.4350824896818053,0.30333487940567255,-0.40095853979099683,-0.22397185441745127,0.028432108717778685,0.27301305063691822,-0.25192228274964534,-0.14863114683187925,0.28767821805764371,0.074864877151857898,0.0060958860489877071,-0.1886691465601831,0.27888880861397208,0.22101482403341643,-0.042421325659174648,-0.4641362158225853,0.29015153113790532,0.10727578426205077,0.24275553953463788,0.22796838264337321,0.1834064903218964,-0.16582617637048117,0.036629473798759159,0.097474294487175442,0.096272282039788382,-0.097037775494073344,0.20593515121014022,0.31202316831136767,-0.431718921507253],"z":[-0.083103138298609755,0.095712819709286551,-0.082649541324748887,0.25385269435306723,-0.042002200778758769,-0.0071475008516018812,0.28273282186253762,0.1717152850487268,0.21851431059680601,-0.10394042408582391,0.27151350656395928,-0.081351201306142734,-0.16588590739359396,-0.10992387618505006,0.07497097929784069,-0.022474175202730054,0.098561757201241343,0.082985109455968306,-0.45147087980696698,-0.046604996091845506,0.011971184371992977,0.29007078423576199,0.18620442481161906,-0.42568599312277094,-0.18710507009240154,0.20493154097654706,-0.24624356317503956,-0.38869169295673422,-0.44689046791020259,0.17134736047213781,-0.46275378583055937,-0.25455776714135586,0.17787053899856511,0.029606315767253373,0.010389574048720027,0.14181503380125057,0.17102965644366144,0.22905493148867551,-0.27049044286143009,-0.24501648159027428,0.11155410825780479,0.034470783434046116,-0.069222381340145397,-0.025599772437966569,0.11098597083138587,0.14959973269317675,-0.11814088411050874,-0.15404574409633312,-0.1866848249989127,0.14484247659891372,-0.00049985041647840952,-0.0031348732968437282,-0.1348464611484019,-0.10463431846480248,-0.097164475413215504,0.044082830932406891,-0.24154083037809443,0.1442485072633658,-0.44490401340823077,0.16582033932254756,0.17283228605379738,-0.11223759538088851,-0.29800661604508843,-0.43950341813396709,-0.12926297685125121,0.17991134551231786,0.18164629550861497,-0.40281955902325939,0.18183016091189672,-0.23715820112797198,-0.058598400158587804,-0.462924378705458,0.040291172777713623,0.29910340855959033,0.30910616576884559,-0.15931981028900175,0.14001472843846954,-0.045666131979173033,-0.38174075727087647,0.067366329013706344,-0.10644772494076481,0.17624313331058034,0.036881616984165901,0.15199248339321877,-0.016361906778599656,0.27309108556065037,0.15292200398055938,0.23743612283412074,0.01453421348785249,0.039880553986125791,0.083722481347741989,-0.056702973605303436,-0.19205118051830561,0.065541516009939044,0.17603837366453387],"text":["CON100-NF-S","CON10-NF-S","CON11-NF-S","CON12-NF-S","CON13-NF-S","CON14-NF-S","CON15-NF-S","CON16-NF-S","CON17-NF-S","CON18-NF-S","CON19-NF-S","CON1-NF-S","CON20-NF-S","CON21-NF-S","CON22-NF-S","CON23-NF-S","CON24-NF-S","CON25-NF-S","CON26-NF-S","CON27-NF-S","CON29-NF-S","CON2-NF-S","CON30-NF-S","CON31-NF-S","CON32-NF-S","CON33-NF-S","CON35-NF-S","CON36-NF-S","CON37-NF-S","CON38-NF-S","CON39-NF-S","CON3-NF-S","CON40-NF-S","CON41-NF-S","CON42-NF-S","CON43-NF-S","CON44-NF-S","CON45-NF-S","CON46-NF-S","CON47-NF-S","CON48-NF-S","CON49-NF-S","CON4-NF-S","CON50-NF-S","CON51-NF-S","CON52-NF-S","CON53-NF-S","CON54-NF-S","CON55-NF-S","CON57-NF-S","CON58-NF-S","CON59-NF-S","CON5-NF-S","CON60-NF-S","CON61-NF-S","CON62-NF-S","CON63-NF-S","CON64-NF-S","CON65-NF-S","CON66-NF-S","CON67-NF-S","CON68-NF-S","CON69-NF-S","CON70-NF-S","CON71-NF-S","CON72-NF-S","CON73-NF-S","CON74-NF-S","CON75-NF-S","CON76-NF-S","CON77-NF-S","CON78-NF-S","CON79-NF-S","CON7-NF-S","CON80-NF-S","CON81-NF-S","CON83-NF-S","CON84-NF-S","CON85-NF-S","CON86-NF-S","CON87-NF-S","CON88-NF-S","CON89-NF-S","CON8-NF-S","CON90-NF-S","CON91-NF-S","CON92-NF-S","CON93-NF-S","CON94-NF-S","CON95-NF-S","CON96-NF-S","CON97-NF-S","CON98-NF-S","CON99-NF-S","CON9-NF-S"],"hovertemplate":["<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>","<i>%{text}<\/i>"],"type":"scatter3d","mode":"markers","name":"NF","marker":{"color":"rgba(177,89,40,1)","line":{"color":"rgba(177,89,40,1)"}},"textfont":{"color":"rgba(177,89,40,1)"},"error_y":{"color":"rgba(177,89,40,1)"},"error_x":{"color":"rgba(177,89,40,1)"},"line":{"color":"rgba(177,89,40,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The <code>aggregate_taxa</code> function merges all rows of the taxa
table together at a specified taxonomic level, in this case the genus
level. As for all tidytacos functions, all other tables in the tidytacos
object are adjusted accordingly.</p>
<p>The <code>tacoplot_ord_ly</code> function will determine relative
abundances of taxa in the samples, and will then use Bray-Curtis
dissimilarities to ordinate samples in a 2-dimensional space based on
their taxonomic composition. The plotly “_ly” addition makes the plot
interactive, which is really nice for exploratory work. This also works
for other plot functions.</p>
</div>
<div class="section level2">
<h2 id="relation-between-community-composition-and-variables">Relation between community composition and variables<a class="anchor" aria-label="anchor" href="#relation-between-community-composition-and-variables"></a>
</h2>
<p>A logical next question is to what extent the niche (nose versus
nasopharynx) determines the community composition variability. Let’s not
forget that everyone has their unique microbiome and include the
variable “participant” in the model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/perform_adonis.html">perform_adonis</a></span><span class="op">(</span><span class="va">urt_genus</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"participant"</span>, <span class="st">"location"</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"margin"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Permutation test for adonis under reduced model</span></span>
<span><span class="co">#&gt; Marginal effects of terms</span></span>
<span><span class="co">#&gt; Permutation: free</span></span>
<span><span class="co">#&gt; Number of permutations: 999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; adonis2(formula = as.formula(paste("counts_matrix", formula_RHS, sep = " ~ ")), data = metadata, permutations = permutations, by = "margin")</span></span>
<span><span class="co">#&gt;              Df SumOfSqs      R2       F Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; participant  97   31.076 0.64174  1.8848  0.001 ***</span></span>
<span><span class="co">#&gt; location      1    3.066 0.06331 18.0372  0.001 ***</span></span>
<span><span class="co">#&gt; Residual     81   13.768 0.28432                   </span></span>
<span><span class="co">#&gt; Total       179   48.424 1.00000                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The <code>perform_adonis</code> function will perform a PERMutational
ANOVA to determine the effect of sample variables on the Bray-Curtis
dissimilarities of the communities. The result shows that participant is
a really important contributor to community composition (R squared =
0.65). Furthermore, there are consistent significant differences between
the communities of nose and nasopharynx (R squared = 0.06).</p>
</div>
<div class="section level2">
<h2 id="differential-abundance-analysis">Differential abundance analysis<a class="anchor" aria-label="anchor" href="#differential-abundance-analysis"></a>
</h2>
<p>Next, we would like to know which of the 20 most abundant genera, are
significantly more abundant in the nasopharynx compared to the nose.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urt_genus</span> <span class="op">&lt;-</span> <span class="va">urt_genus</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/add_codifab.html">add_codifab</a></span><span class="op">(</span><span class="va">location</span>, max_taxa <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="va">urt_genus</span><span class="op">$</span><span class="va">taxon_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">urt_genus</span><span class="op">$</span><span class="va">taxon_pairs</span>, <span class="va">wilcox_p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tacoplot_codifab.html">tacoplot_codifab</a></span><span class="op">(</span><span class="va">urt_genus</span>, <span class="va">NF_vs_N</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/codifab-1.png" class="r-plt" alt="" width="768"></p>
<p>The <code>add_codifab</code> function will add a table called
taxon_pairs to the tidytacos object, with for each pair of a taxon and a
reference taxon, the differential abundance of the taxon between the two
conditions (with respect to the reference taxon).</p>
<p>The <code>codifab_plot</code> function returns a plot to visualize
differential abundance of taxa between conditions, compared to all other
taxa as references. We can observe that <em>Haemophilus</em> is most
likely to be typical for the Nasopharynx, whereas <em>Anaerococcus</em>
is most likely to be typical for the nose.</p>
<p>Of note, there are many differential abundance analysis methods out
there and none of them are perfect. Interpret your results with
care.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Wittouck, Tim Van Rillaer, Wenke Smets, Sarah Lebeer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
